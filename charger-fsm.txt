+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
| state\event     | query status    | query status ack, changed | query status ack, not changed | query config    | query config ack | config        | config ack | cmd timeout, retry > 0 | cmd timeout, retry = 0 | sync timeout     | online, tx free | online, tx free, scan timer |
+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
|                 | set retry = 2   |                           |                               | set retry = 2   |                  | set retry = 2 |            |                        |                        |                  | set retry = 2   |                             |
|                 | set cmd timer   |                           |                               | set cmd timer   |                  | set cmd timer |            |                        |                        |                  | set cmd timer   |                             |
|                 | set activated   |                           |                               | set activated   |                  | set activated |            |                        |                        |                  | set pin = 0     |                             |
|                 | query status    |                           |                               | query config    |                  | config        |            |                        |                        |                  | query status    |                             |
|                 | ----            |                           |                               | ----            |                  | ----          |            |                        |                        |                  | ----            |                             |
| READY           | QUERYING STATUS |                           |                               | QUERYING CONFIG |                  | CONFIGING     |            |                        |                        |                  | SCANNING        |                             |
+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
|                 |                 |                           |                               |                 |                  |               |            | retry - 1              | clear cache            |                  |                 |                             |
|                 |                 | ack query status          |                               |                 |                  |               |            | set cmd timer          | set unactivated        |                  |                 |                             |
|                 |                 | ----                      | ----                          |                 |                  |               |            | query status           | ----                   |                  |                 |                             |
| QUERYING STATUS |                 | READY                     | READY                         |                 |                  |               |            | ----                   | READY                  |                  |                 |                             |
+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
|                 |                 |                           |                               |                 |                  |               |            | retry - 1              |                        |                  |                 |                             |
|                 |                 |                           |                               |                 | ack query config |               |            | set cmd timer          | set unactivated        |                  |                 |                             |
|                 |                 |                           |                               |                 | ----             |               |            | query config           | ----                   |                  |                 |                             |
| QUERYING CONFIG |                 |                           |                               |                 | READY            |               |            | ----                   | READY                  |                  |                 |                             |
+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
|                 |                 |                           |                               |                 |                  |               |            | retry - 1              |                        |                  |                 |                             |
|                 |                 |                           |                               |                 |                  |               | ack config | set cmd timer          | set unactivated        |                  |                 |                             |
|                 |                 |                           |                               |                 |                  |               | ----       | config                 | ----                   |                  |                 |                             |
| CONFIGING       |                 |                           |                               |                 |                  |               | READY      | ----                   | READY                  |                  |                 |                             |
+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
|                 | set retry = 2   |                           |                               | set retry = 2   |                  | set retry = 2 |            |                        |                        |                  |                 |                             |
|                 | set cmd timer   |                           |                               | set cmd timer   |                  | set cmd timer |            |                        |                        |                  |                 | set retry = 2               |
|                 | set activated   | set activated             |                               | set activated   |                  | set activated |            | retry - 1              | clear cache            |                  |                 | set cmd timer               |
|                 | query status    | reset retry               | set activated                 | query config    | ack query config | config        | ack config | set cmd timer          | set unactivated        | ack query status |                 | set pin = 0                 |
|                 | ----            | ack query status          | reset retry                   | ----            | ----             | ----          | ----       | query status           | ----                   | ----             |                 | query status                |
| SCANNING        | QUERYING STATUS | ----                      | ----                          | QUERYING CONFIG | READY            | CONFIGING     | READY      | ----                   | READY                  | READY            |                 | ----                        |
+-----------------+-----------------+---------------------------+-------------------------------+-----------------+------------------+---------------+------------+------------------------+------------------------+------------------+-----------------+-----------------------------+
